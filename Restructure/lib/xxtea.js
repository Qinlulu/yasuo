define(["require","exports","module"],function(e,t,n){function s(e,t){var n=e.length,r=n<<2;if(t){var i=e[n-1];r-=4;if(i<r-3||i>r)return null;r=i}for(var s=0;s<n;s++)e[s]=String.fromCharCode(e[s]&255,e[s]>>>8&255,e[s]>>>16&255,e[s]>>>24&255);var o=e.join("");return t?o.substring(0,r):o}function o(e,t){var n=e.length,r=n>>2;(n&3)!==0&&++r;var i;t?(i=new Array(r+1),i[r]=n):i=new Array(r);for(var s=0;s<n;++s)i[s>>2]|=e.charCodeAt(s)<<((s&3)<<3);return i}function u(e){return e&4294967295}function a(e,t,n,r,i,s){return(n>>>5^t<<2)+(t>>>3^n<<4)^(e^t)+(s[r&3^i]^n)}function f(e){return e.length<4&&(e.length=4),e}function l(e,t){var n=e.length,r=n-1,s,o,f,l,c,h;o=e[r],f=0;for(h=Math.floor(6+52/n)|0;h>0;--h){f=u(f+i),l=f>>>2&3;for(c=0;c<r;++c)s=e[c+1],o=e[c]=u(e[c]+a(f,s,o,c,l,t));s=e[0],o=e[r]=u(e[r]+a(f,s,o,r,l,t))}return e}function c(e,t){var n=e.length,r=n-1,s,o,f,l,c,h;s=e[0],h=Math.floor(6+52/n);for(f=u(h*i);f!==0;f=u(f-i)){l=f>>>2&3;for(c=r;c>0;--c)o=e[c-1],s=e[c]=u(e[c]-a(f,s,o,c,l,t));o=e[r],s=e[0]=u(e[0]-a(f,s,o,0,l,t))}return e}function h(e){if(/^[\x00-\x7f]*$/.test(e))return e;var t=[],n=e.length;for(var r=0,i=0;r<n;++r,++i){var s=e.charCodeAt(r);if(s<128)t[i]=e.charAt(r);else if(s<2048)t[i]=String.fromCharCode(192|s>>6,128|s&63);else{if(!(s<55296||s>57343)){if(r+1<n){var o=e.charCodeAt(r+1);if(s<56320&&56320<=o&&o<=57343){var u=((s&1023)<<10|o&1023)+65536;t[i]=String.fromCharCode(240|u>>18&63,128|u>>12&63,128|u>>6&63,128|u&63),++r;continue}}throw new Error("Malformed string")}t[i]=String.fromCharCode(224|s>>12,128|s>>6&63,128|s&63)}}return t.join("")}function p(e,t){var n=new Array(t),r=0,i=0;for(var s=e.length;r<t&&i<s;r++){var o=e.charCodeAt(i++);switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n[r]=o;break;case 12:case 13:if(!(i<s))throw new Error("Unfinished UTF-8 octet sequence");n[r]=(o&31)<<6|e.charCodeAt(i++)&63;break;case 14:if(!(i+1<s))throw new Error("Unfinished UTF-8 octet sequence");n[r]=(o&15)<<12|(e.charCodeAt(i++)&63)<<6|e.charCodeAt(i++)&63;break;case 15:if(!(i+2<s))throw new Error("Unfinished UTF-8 octet sequence");var u=((o&7)<<18|(e.charCodeAt(i++)&63)<<12|(e.charCodeAt(i++)&63)<<6|e.charCodeAt(i++)&63)-65536;if(!(0<=u&&u<=1048575))throw new Error("Character outside valid Unicode range: 0x"+u.toString(16));n[r++]=u>>10&1023|55296,n[r]=u&1023|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+o.toString(16))}}return r<t&&(n.length=r),String.fromCharCode.apply(String,n)}function d(e,t){var n=[],r=new Array(32768),i=0,s=0;for(var o=e.length;i<t&&s<o;i++){var u=e.charCodeAt(s++);switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r[i]=u;break;case 12:case 13:if(!(s<o))throw new Error("Unfinished UTF-8 octet sequence");r[i]=(u&31)<<6|e.charCodeAt(s++)&63;break;case 14:if(!(s+1<o))throw new Error("Unfinished UTF-8 octet sequence");r[i]=(u&15)<<12|(e.charCodeAt(s++)&63)<<6|e.charCodeAt(s++)&63;break;case 15:if(!(s+2<o))throw new Error("Unfinished UTF-8 octet sequence");var a=((u&7)<<18|(e.charCodeAt(s++)&63)<<12|(e.charCodeAt(s++)&63)<<6|e.charCodeAt(s++)&63)-65536;if(!(0<=a&&a<=1048575))throw new Error("Character outside valid Unicode range: 0x"+a.toString(16));r[i++]=a>>10&1023|55296,r[i]=a&1023|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+u.toString(16))}if(i>=32766){var f=i+1;r.length=f,n[n.length]=String.fromCharCode.apply(String,r),t-=f,i=-1}}return i>0&&(r.length=i,n[n.length]=String.fromCharCode.apply(String,r)),n.join("")}function v(e,t){if(t===undefined||t===null||t<0)t=e.length;return t===0?"":/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e)?t===e.length?e:e.substr(0,t):t<65535?p(e,t):d(e,t)}function m(e,t){return e===undefined||e===null||e.length===0?e:(e=h(e),t=h(t),s(l(o(e,!0),f(o(t,!1))),!1))}function g(e,t){return r.btoa(m(e,t))}function y(e,t){return e===undefined||e===null||e.length===0?e:(t=h(t),v(s(c(o(e,!1),f(o(t,!1))),!0)))}function b(e,t){return e===undefined||e===null||e.length===0?e:y(r.atob(e),t)}var r={};typeof r.btoa=="undefined"&&(r.btoa=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return function(t){var n,r,i,s,o,u,a;r=i=0,s=t.length,o=s%3,s-=o,u=s/3<<2,o>0&&(u+=4),n=new Array(u);while(r<s)a=t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<8|t.charCodeAt(r++),n[i++]=e[a>>18]+e[a>>12&63]+e[a>>6&63]+e[a&63];return o==1?(a=t.charCodeAt(r++),n[i++]=e[a>>2]+e[(a&3)<<4]+"=="):o==2&&(a=t.charCodeAt(r++)<<8|t.charCodeAt(r++),n[i++]=e[a>>10]+e[a>>4&63]+e[(a&15)<<2]+"="),n.join("")}}()),typeof r.atob=="undefined"&&(r.atob=function(){var e=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return function(t){var n,r,i,s,o,u,a,f,l,c;a=t.length;if(a%4!==0)return"";if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(t))return"";t.charAt(a-2)=="="?f=1:t.charAt(a-1)=="="?f=2:f=0,l=a,f>0&&(l-=4),l=(l>>2)*3+f,c=new Array(l),o=u=0;while(o<a){n=e[t.charCodeAt(o++)];if(n==-1)break;r=e[t.charCodeAt(o++)];if(r==-1)break;c[u++]=String.fromCharCode(n<<2|(r&48)>>4),i=e[t.charCodeAt(o++)];if(i==-1)break;c[u++]=String.fromCharCode((r&15)<<4|(i&60)>>2),s=e[t.charCodeAt(o++)];if(s==-1)break;c[u++]=String.fromCharCode((i&3)<<6|s)}return c.join("")}}());var i=2654435769;n.exports={utf8Encode:h,utf8Decode:v,encrypt:m,encryptToBase64:g,decrypt:y,decryptFromBase64:b}});